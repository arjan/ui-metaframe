(function(a){a.widget("ui.metaframe",{_init:function(){var d=this;d.popup=d.element.find(".metaframe-popup:first");d.trigger=d.element.find(".metaframe-trigger");d.popup.css({top:0,left:0,opacity:0,display:"block"});var e=d.trigger.clone(true).css({margin:0});d.popup.find(".metaframe-placeholder").empty().append(e);var f=d.popup.find(".metaframe-placeholder").offset();var g=function(h){return d.trigger.css(h)?parseInt(d.trigger.css(h)):0};var c=g("borderTopWidth")+g("padding-top");var b=g("borderLeftWidth")+g("padding-left");d.offset={top:-f.top+c,left:-f.left+b};d.showing=false;d.showTimer=null;d.hideTimer=null;d.timeout=2;d.trigger.mouseover(function(){if(d.showTimer||d.showing){return}d.showTimer=setTimeout(function(){d.doShow()},d.timeout)}).mouseout(function(){if(d.hideTimer||!d.showing){return}d.hideTimer=setTimeout(function(){d.doHide()},d.timeout)});d.popup.mouseover(function(){if(d.hideTimer){clearTimeout(d.hideTimer);d.hideTimer=null}}).mouseout(function(){d.hideTimer=setTimeout(function(){d.doHide()},d.timeout)});a("body").append(d.popup)},doShow:function(){var b=this;var c=b.trigger.find("*").offset()||b.trigger.offset();b.popup.css({top:c.top+b.offset.top,left:c.left+b.offset.left,opacity:0});b.popup.show();b.popup.animate({opacity:1});b.showTimer=null;b.showing=true;b._trigger("show")},doHide:function(){var b=this;b.popup.fadeOut(100);b.showing=false;b.hideTimer=null;b._trigger("hide")}})})(jQuery);